<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Continuation · CTDirect.jl</title><meta name="title" content="Continuation · CTDirect.jl"/><meta property="og:title" content="Continuation · CTDirect.jl"/><meta property="twitter:title" content="Continuation · CTDirect.jl"/><meta name="description" content="Documentation for CTDirect.jl."/><meta property="og:description" content="Documentation for CTDirect.jl."/><meta property="twitter:description" content="Documentation for CTDirect.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">CTDirect.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><a class="tocitem" href="tutorial.html">Tutorial</a></li><li class="is-active"><a class="tocitem" href="continuation.html">Continuation</a><ul class="internal"><li><a class="tocitem" href="#Continuation-on-speed-constraint"><span>Continuation on speed constraint</span></a></li><li><a class="tocitem" href="#Continuation-on-maximal-thrust"><span>Continuation on maximal thrust</span></a></li></ul></li><li><a class="tocitem" href="api.html">API</a></li><li><a class="tocitem" href="dev-api.html">Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="continuation.html">Continuation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="continuation.html">Continuation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/control-toolbox/CTDirect.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/control-toolbox/CTDirect.jl/blob/main/docs/src/continuation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Discrete-continuation"><a class="docs-heading-anchor" href="#Discrete-continuation">Discrete continuation</a><a id="Discrete-continuation-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-continuation" title="Permalink"></a></h1><p>Using the warm start option, it is easy to implement a basic discrete continuation method, where a sequence of problems is solved using each solution as initial guess for the next problem. This usually gives better and faster convergence than solving each problem with the same initial guess. We illustrate this on the Goddard problem already presented in the tutorial.</p><pre><code class="language-julia hljs">using CTDirect
using CTBase

Cd = 310
Tmax = 3.5
β = 500
b = 2
function F0(x)
    r, v, m = x
    D = Cd * v^2 * exp(-β*(r - 1))
    return [ v, -D/m - 1/r^2, 0 ]
end
function F1(x)
    r, v, m = x
    return [ 0, Tmax/m, -b*Tmax ]
end

ocp = Model(variable=true)
state!(ocp, 3)
control!(ocp, 1)
variable!(ocp, 1)
time!(ocp, 0, Index(1))
constraint!(ocp, :initial, [1,0,1], :initial_constraint)
constraint!(ocp, :final, Index(3), 0.6, :final_constraint)
constraint!(ocp, :state, 1:2:3, [1,0.6], [1.2,1], :state_box)
constraint!(ocp, :control, Index(1), 0, 1, :control_box)
constraint!(ocp, :variable, Index(1), 0.01, Inf, :variable_box)
constraint!(ocp, :state, Index(2), 0, Inf, :speed_limit)
objective!(ocp, :mayer, (x0, xf, v) -&gt; xf[1], :max)
dynamics!(ocp, (x, u, v) -&gt; F0(x) + u*F1(x) )

sol0 = solve(ocp, print_level=0)
sol = sol0
@printf(&quot;Objective for reference solution %.6f\n&quot;, sol0.objective)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Objective for reference solution 1.012832</code></pre><h2 id="Continuation-on-speed-constraint"><a class="docs-heading-anchor" href="#Continuation-on-speed-constraint">Continuation on speed constraint</a><a id="Continuation-on-speed-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-on-speed-constraint" title="Permalink"></a></h2><p>Let us solve a sequence of problems with an increasingly strict constraint on the maximal speed.</p><pre><code class="language-julia hljs">vmax_list = []
obj_list = []
iter_list = []
print(&quot;vmax &quot;)
for vmax=0.15:-0.01:0.05
    print(vmax,&quot; &quot;)
    remove_constraint!(ocp, :speed_limit)
    constraint!(ocp, :state, Index(2), 0, vmax, :speed_limit)
    global sol = solve(ocp, print_level=0, init=OptimalControlInit(sol))
    push!(vmax_list, vmax)
    push!(obj_list, sol.objective)
    push!(iter_list, sol.iterations)
end
@printf(&quot;\nAverage iterations %d\n&quot;, mean(iter_list))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">vmax 0.15 0.14 0.13 0.12 0.11 0.1 0.09 0.08 0.07 0.06 0.05
Average iterations 17</code></pre><p>We now plot the objective with respect to the speed limit, as well as a comparison of the solutions for the unconstrained case and the vmax=0.05 case.</p><pre><code class="language-julia hljs">pobj = plot(vmax_list, obj_list, label=&quot;r(tf)&quot;,seriestype=:scatter)
xlabel!(&quot;Speed limit (vmax)&quot;)
ylabel!(&quot;Maximal altitude r(tf)&quot;)
plot(sol0)
p = plot!(sol)
plot(pobj, p, layout=2)</code></pre><img src="continuation-9a9bdc30.svg" alt="Example block output"/><p>We can compare with solving each problem with the default initial guess, which here gives the same solutions but takes more iterations overall.</p><pre><code class="language-julia hljs">iter_list = []
for vmax=0.15:-0.01:0.05
    print(vmax,&quot; &quot;)
    remove_constraint!(ocp, :speed_limit)
    constraint!(ocp, :state, Index(2), 0, vmax, :speed_limit)
    global sol = solve(ocp, print_level=0)
    push!(iter_list, sol.iterations)
end
@printf(&quot;\nAverage iterations %d\n&quot;, mean(iter_list))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.15 0.14 0.13 0.12 0.11 0.1 0.09 0.08 0.07 0.06 0.05
Average iterations 32</code></pre><h2 id="Continuation-on-maximal-thrust"><a class="docs-heading-anchor" href="#Continuation-on-maximal-thrust">Continuation on maximal thrust</a><a id="Continuation-on-maximal-thrust-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-on-maximal-thrust" title="Permalink"></a></h2><p>As a second example, we now solve the problem for a decreasing maximal thrust Tmax. first we reset the speed constraint.</p><pre><code class="language-julia hljs">remove_constraint!(ocp, :speed_limit)
vmax = 0.1
constraint!(ocp, :state, Index(2), 0, vmax, :speed_limit)
sol = solve(ocp, print_level=0)
sol0 = sol</code></pre><p>Then we perform the continuation</p><pre><code class="language-julia hljs">Tmax_list = []
obj_list = []
print(&quot;Tmax &quot;)
for Tmax_local=3.5:-0.5:1
    global Tmax = Tmax_local
    print(Tmax,&quot; &quot;)
    global sol = solve(ocp, print_level=0, init=OptimalControlInit(sol))
    push!(Tmax_list, Tmax)
    push!(obj_list, sol.objective)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Tmax 3.5 3.0 2.5 2.0 1.5 1.0</code></pre><p>And plot the results as before</p><pre><code class="language-julia hljs">pobj = plot(Tmax_list, obj_list, label=&quot;r(tf)&quot;,seriestype=:scatter)
xlabel!(&quot;Maximal thrust (Tmax)&quot;)
ylabel!(&quot;Maximal altitude r(tf)&quot;)
plot(sol0)
p = plot!(sol)
plot(pobj, p, layout=2)</code></pre><img src="continuation-a774f609.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="tutorial.html">« Tutorial</a><a class="docs-footer-nextpage" href="api.html">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Monday 22 April 2024 15:17">Monday 22 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
